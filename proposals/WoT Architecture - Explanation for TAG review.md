# Web of Things Architecture
## Explanation document for TAG review

## Background 
Internet of Things (IoT) services are increasingly using web standards in both commercial
and industrial applications.
However, the specialized needs of IoT services has also given rise to
several new standards.
IoT services also often need to integrate with pre-existing vertical standards.
This diversity has unfortunately led to market fragmentation and many
difficult system integration problems.
The goal of the Web of Things (WoT) is to improve interoperability 
and usability of IoT services and to counter this fragmentation.

After some initial academic publications exploring the use of web standards for IoT,
the first <a href="https://www.w3.org/2014/02/wot/">W3C Web of Things Workshop</a>
was held in 2014 with the goal of further examining the potential for open standards 
as a basis for IoT services.
Based on the interest generated by this workshop, the
W3C chartered a Web of Things Interest Group in 2015 to
identify technological building blocks for Recommendation Track
standardization. 

The overall strategy has been to survey IoT use cases,
identify common building blocks, define suitable layers of abstraction,
and provide mechanisms to describe 
the affordances provided by IoT services independent of low-level protocols.
Notably, compared to other standards approaches, the WoT has take a
descriptive rather than a prescriptive approach.
In other words, rather than requiring an IoT service to be built
in a particular way to be usable by other IoT services, metadata is
provided so that users of an IoT service can interface to it.
This potentially allows the WoT standards to be
applied to pre-existing as well as new IoT services, and 
allows for a wide variety of IoT service implementation approaches.

Based on the work of the Web of Things Working Group which was begun at the end of 2016, 
documents for the first set of WoT building blocks are now being published:
	
- the <a href="https://w3c.github.io/wot-thing-description/">WoT
		Thing Description</a> (REC track),
- the <a href="https://w3c.github.io/wot-binding-templates/">WoT
		Binding Templates</a>,
- the <a href="https://w3c.github.io/wot-scripting-api/">WoT
		Scripting API</a>, 
- the <a href="https://w3c.github.io/wot-security/">WoT
		Security and Privacy Considerations</a>, 
		
The architecture document serves as an umbrella for the W3C WoT 
specifications and defines basics such as terminology
and the underlying abstract architecture of the W3C Web of Things. 
In particular, the purpose of this document is to provide

- a set of use cases that lead to the W3C WoT Architecture,
- a set of requirements for WoT implementations,
- an overview of the WoT building blocks being standardized
	and their interplay,
- a guide to mapping the abstract architecture to software
	stacks and hardware components,
- and overview of the security and privacy considerations to be 
        aware of when implementing the WoT building blocks.

## Abstract
The W3C Web of Things (WoT) was created to enable
interoperability across IoT platforms and application domains.
<!-- DOES INTEROPERABILITY ACROSS APPLICATION DOMAINS EVEN MAKE SENSE?  
     SHOULDN'T THIS BE "LOWER-LEVEL STANDARDS" OR SOMETHING? -->

WoT provides mechanisms to formally describe IoT interfaces
to allow IoT devices and services to communicate with each other,
independent of their underlying implementation, and across multiple
networking protocols. 
In addition WoT offers a standardized way to define and program IoT behavior.

This WoT Architecture document describes the abstract architecture for the W3C
Web of Things. It is derived from a set of requirements that were in turn derived
from use cases for multiple application domains.
The architecture can be mapped onto a variety of concrete deployment scenarios, 
several examples of which are given. 

The document is focused on the
scope of W3C WoT standardization, which consists of three initial
building blocks: the _WoT Thing Description_,
the _WoT Binding Templates_, and the _WoT Scripting API_.

The *WoT Thing Description* is the primary building block, 
as it describes the network-facing interface of a Thing (_WoT
Interface_).
The informative *WoT Binding Templates* document demonstrates
how a _WoT Thing Description_ can be used to describe 
multiple protocol bindings, so that a _Thing_ can communicate 
with different _IoT Platforms_ (i.e., IoT ecosystems or standards).

The optional *WoT Scripting API* enables implementation of the application logic
of a Thing using a standardized contract for JavaScript. 
This simplifies IoT application development and enables
portability across vendors and WoT network components.		

Other non-normative architectural blocks and conditions
underlying the Web of Things are also described in the context of
deployment scenarios. 
In particular, general recommendations for security and
privacy are included in the 
_WoT Security and Privacy Considerations_ document.
Discussions of more specfic security and privacy considerations 
are also given in each document.
The goal of WoT security is to preserve and support
existing device mechanisms and properties, not define new mechanisms. 

In general, W3C WoT is
designed to describe what exists rather than to prescribe what to
implement.

## Application domains and use cases

The Web of Things architecture does not put any limitations on use cases and application domains. 
Various application domains have been considered to collect common patterns 
that have to be satisfied by the abstract architecture. 

The following sections are not exhaustive. 
Rather they serve as illustrations of
where connected things can provide additional benefit or enable new scenarios.

### Consumer

In the consumer space there are multiple assets that can benefit from being connected; among
others:
* Lights and air conditioners can be turned off based on room occupancy. 
* Window blinds can be closed automatically based on weather conditions and presence.
* Energy and other resource consumption can be optimized based on usage patterns and predictions.

### Industrial

The industrial use cases in this section are applicable to different industry verticals. 
Due to the nature of overlaps in the application scenarios, 
different verticals have similar use cases.

#### Manufacturing
* Smart factories require advanced monitoring of the connected manufacturing equipment 
  as well of the manufactured products.  They benefit from predictions of machine failures and 
  early discovery of anomalies to prevent costly downtime and maintenance efforts.

* Monitoring of connected manufacturing equipment and the environment at the production facility 
  for the presence of poisonous gases, 
  excessive noise or heat increases the safety of the workers and reduces the risks of incidents or accidents.

* Real-time monitoring and KPI calculations of production equipment 
  helps to detect productivity problems and optimize the supply chain.

#### Transportation & Logistics

* Monitoring of vehicles, fuel costs, maintenance needs and assignments 
  helps to optimize the full utilization of the vehicle fleet.

* Shipments can be tracked en-route to ensure consistent quality and condition of 
  transported goods. 
  This is especially useful to assert the integrity of the cold-chain from warehouses 
  to refrigerated trucks to delivery.

* Centralized monitoring and management of stock in warehouses and yards 
  can prevent out of stock and excessive stock situations.

#### Utilities

* Automated reading of residential and C&I (Commercial and Industrial) meters 
  integrated with billing offers continuous insights into
  resource consumption and potential bottlenecks.

* Monitoring the condition and output of distributed renewable energy generation 
  equipment enables optimisation of distributed energy resources.

* Monitoring and remote control of distribution equipment
  helps to automate distribution.

* Continuous monitoring of generation and distribution infrastructure 
  can improve the safety of utilities crews in the field.

#### Oil and Gas

* Offshore platform monitoring, leakage detection and prediction 
  of pipeline usage as well as monitoring and controlling the levels 
  in tanks and reservoirs helps to improve the industrial safety for 
  the workforce as well as avoiding damage to the environment.

* Automated calculation of a distributed stock through various storage tanks 
  and delivery pipes/trucks allows for improved planning and resource usage.

#### Insurance

* Proactive asset monitoring of high value assets such as connected structures, 
  fleet vehicles, etc. mitigates the risk of severe damage and high costs 
  through use of predictions and early detection of incidents.

* Usage based insurance can be offered with usage tracking and customized insurance policies.
	
* Predictive weather monitoring and re-routing of fleet vehicles to covered garages 
  can limit loss due to hail and tree damage in the case of severe weather.

#### Engineering and Construction

* Industrial safety monitoring reduces the risks of security hazards.
* Asset monitoring at construction sites can prevent damage and loss.

### Agriculture

* Soil condition monitoring and creation of optimal plans for watering, fertilizing, 
  and monitoring production conditions optimizes the quality and output of agricultural processes.

### Healthcare

* Data collection and analytics of clinical trial data helps to gain insights into new areas.

* Remote patient monitoring mitigates the risk of undetected critical situations 
  for elderly people and patients after hospitalization.

### Environment

* Environmental monitoring typically relies on a lot of distributed sensors 
  that send their measurement data to common gateways, edge devices and cloud services.

* Monitoring of air pollution, water pollution and other environmental risk factors 
  such as fine dust, ozone, volatile organic compounds, radioactivity, temperature, and humidity
  can be used to detect critical environment conditions 
  and can help prevent unrecoverable health or environment damages.

### Smart cities

* Monitoring of bridges, dams, levees, and canals for material condition, deterioration, and
  vibrations can discover needed maintenance repair work and help prevent significant damage.

* Monitoring of highways and providing appropriate signage ensures optimized traffic flow.

* Smart parking optimizes and tracks the usage and availability of parking spaces and automates billing/reservations.

* Smart control of street lights based on presence detection and weather predictions can 
  reduce energy costs.

* Garbage containers can be monitored to optimize waste management and the trash collection route.

### Smart buildings

* Monitoring energy usage throughout buildings helps to optimize resource consumption and reduce waste.

* Monitoring equipment in buildings such as HVAC, elevators, lighting etc. 
  and fixing problems early improves the satisfaction of occupants.

### Connected Car

* Monitoring of operation status and prediction of service needs optimizes maintenance costs.
* Driver safety is enhanced with notifications from an early warning system for critical road and traffic conditions.

## What is being standardized?

This document defines a common "WoT Architecture" and serves as an entry point and
introduction to several other documents defining the WoT Building Blocks.

### Common Architecture
Based on the application domains and use cases, and the requirements derived from these,
a common abstract architecture has been defined for WoT systems.
This abstract architecture is broad enough to include many existing IoT systems and standards.
This is intentional since, in order to combat fragmentation,
the WoT approach is designed to allow the construction of IoT
systems composed of devices and services supporting many standards, platforms, and protocols
in multiple verticals.
The abstract architecture also defines a set of reference patterns and a set of terminology that can
be used to avoid confusion when describing a WoT system.

The main requirement for an IoT device or service to operate as part of a WoT system 
(and be considered a "WoT Thing") is that _it must be described in a WoT Thing Description_.
The WoT Thing Description provides basic metadata about a WoT Thing, such as a name, description, and 
id, and also provides all the metadata needed to interact with a device.

### Building Blocks
The Web of Things defines specific building blocks to allow the implementation of systems that
conform with the abstract WoT Architecture.
The specifics of these building blocks are defined in separate documents; 
this document provides an overview and a summary.

## Common Patterns
TO DO

## Requirements
TO DO

## Architectural Aspects of a Thing

A WoT Thing has four architectural aspects of interest: 
its behavior, 
its interactions, 
the specific additional information needed by a client 
to implement each interaction in a concrete protocol 
(what we will call the protocol binding), 
and its security configuration.  

<img src="../images/wot-building-blocks.png"/>

The behavior aspect of a WoT Thing 
includes both lifecycle management (onboarding, updating, decommissioning, etc) and
its operational behavior.
Operational behaviour includes autonomous activity and computation, 
network interactions, sensing, and actuation.

The interaction aspect of a Thing can be described in terms
of generic and abstract operations like setting and getting a property,
invoking an action, or subscribing to an event notification, among others.
The WoT architecture separates these abstract interactions from their implementation in
particular protocols in order to enhance interoperability.
A single WoT Thing may, in general, use multiple protocols, i
including but not limited to HTTP, CoAP, and MQTT.
These protocols are used both to support a WoT Thing's 
own interactions (as a server) and to connect to other WoT Things (as a client).
Some of these protocols use the client-server model, 
others support a subscribe-publish model.
The latter is especially important for low-power devices 
and use cases requiring timely event notifications.
Our main constraint on protocols is that they must support 
the use of URLs to describe access addresses.
We define the term "servient" for devices or services,
such as WoT Things, that can be either a server/publisher, 
a client/subscriber, or both. 

Protocol bindings augment each interaction with the additional detail needed to implement it
with a particular concrete protocol.

The security configuration aspect represents the mechanisms 
used to control access to the affordances and the 
management of related public and private metadata.
WoT Things in general also need to maintain their own integrity
and the integrity and confidentiality of the data they manage, 
and limit access to interactions to authenticated
and authorized users, devices, and services.

### Building Blocks
The WoT Building Blocks support each of these aspects, 
and are the focus of our standardization effort.
Each of these building blocks is defined in a separate document.

<img src="../images/wot-thing-with-scripting.png"/>

#### WoT Thing Description
The primary building block is the 
<a>WoT Thing Description</a>,
which encodes metadata about the WoT Thing (name, identifier, version, etc.),
links to related entities,
its set of interactions, 
data schemas and protocol bindings for those interactions, 
and public security metadata.
We define the term Interaction Affordances to refer to the metadata describing the interactions supported by a WoT Thing. 
A WoT Thing Description also supports but does not require RDF/JSON-LD (Linked Data) 
processing and semantic annotation and inteferencing [[?LINKED-DATA]].

The WoT Thing Description building block fosters interoperability in two ways: 
* First, it enables machine-to-machine communication, as devices can
  read WoT Thing Descriptions and use the information contained in them
  to automatically adapt to details of a particular protocol, using
  the interaction/protocol binding abstraction.
* Second, they can serve as a common, uniform format for developers to document and
  retrieve all details necessary to access IoT devices and make use of their data.
To better support semantic interoperability, WoT Thing Descriptions may 
optionally make use of domain-specific vocabularies, 
for which explicit extension points are provided. 
However domain-specific vocabularies themselves are out of scope of the 
current WoT standardization activity.

#### WoT Scripting API
A second (optional) building block is the WoT Scripting API. 
This building block allows the definition of the behavior
of a WoT Thing (responses to interactions) 
and the Consumption (parsing and use) 
and Exposure (construction and publication) of
WoT Thing Descriptions.  
This building block is optional because devices can choose to
implement behaviors and construct or consume WoT Thing Descriptions by other
means than using the WoT Scripting API.  
In particular, WoT Thing Descriptions do not need to be be provided
by the device itself, but can be provided separately (for example by
a web service or database).
This is necessary for supporting brownfield (pre-existing)
devices and services.  
However, the WoT Scripting API can be used to simplify and support the development of 
*new* WoT Things or services that need to connect to WoT Things.
The WoT Scripting API specification targets implementation in JavaScript 
and is consistent with both browser and server use cases, 
although the focus is on its use in devices and services.

### WoT Binding Templates
The IoT uses a variety of protocols for accessing devices, since no
one protocol is appropriate in all contexts. Thus, a central
challenge for the Web of Things is to enable interactions with the
plethora of different _IoT Platforms_ (e.g., OCF, oneM2M, OMA
LWM2M, OPC-UA, etc.) and RESTful devices that do not follow any
particular standard, but provide an interface over standardized protocols
such as HTTP, CoAP, or MQTT. 

WoT is tackling this variety by supporting the encoding of protocol
binding details in the WoT Thing Description but also
by publishing an informational document,
the WoT Binding Templates [[?wot-binding-templates]].
This building block provides a collection of communication metadata blueprints 
that explain how to encode the metadata needed to interact with different IoT platforms.
in a WoT Thing Description.

### WoT Security and Privacy Considerations
The final building block is security, which is a cross-cutting concern.
IoT devices and services generally have strong security and privacy requirements,
and the WoT Architecture deals with this aspect of WoT systems in several ways.

First, the WoT Thing Description itself supports the description of public
security metadata so that consumers of a WoT Thing know what mechanisms they
need to support to gain access.  
This follows security best practices
of documenting security mechanisms and controlling access through specific 
private information (eg keys) rather than depending on security through obscurity.

Second, the WoT Scripting API is designed to not have direct access to
private keying information.  This must be provisioned separately.

Third, we have done an analysis of the threats and risks to a WoT system
and published this analysis in the <a>WoT Security and Privacy Considerations</a>
document.  In addition to a set of risks common to all
IoT systems, this document also considers the additional risks and opportunities
afforded by the other WoT Building Blocks, and how to mitigate them.  
For example, a WoT Thing
Description gives a potential attacker information that may help in
identifying and attacking a vulnerable system... but it also helps a 
system integrator or user manage that information and identify the same
vulnerable systems and mitigate their vulnerabilities.
Each normative document also includes a set of security and privacy
considerations specific to that document.

Fourth, we have developed a <a>WoT Security Testing Plan</a>
and a set of <a>WoT Best Practices</a>.
These informational documents are intended to help developers 
secure WoT system implementations.
